<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <title>Profile</title>
</head>

<body>
    <header class="header-viewAppointments">
        <div class="sidebar-menu-btn" id="menu-btn">
            <img src="../assets/images/menu-logo.png" alt="">
            <div class="category-name"><h1 >PROFILE</h1></div>
        </div>
        <div class="selection">
            <a href="#"><img src="../assets/images/search-icon.png" class="search"></a>
            <a href="#"><img src="../assets/images/notif-icon.png" class="notif"></a>
            <div class="dropdown">
                <a class="user-dropdown-btn"><img src="../assets/images/user-icon.png" class="user"></a>
                <div class="dropdown-content">
                    <a href="../Admin Side/profile.html">Profile</a>
                    <a href="../Admin Side/change-password.html">Change Password</a>
                    <a href="../General/index.html">Log Out</a>
                </div>
            </div> 
        </div>
    </header>
    <div class="sidebar">
        <div class="top">
            <div class="sidebar-logo">
                <img src="../assets/images/TUP AS LOGO.png" alt="logo">
            </div>
            <p class="user-info">Name Here</p>
        </div>
        <div class="menu-items">
            <ul>
                <li><a href="../Admin Side/appointments.html">Home</a></li>
                <!---<li><a href="../Admin Side/appointment-details.html">Appointment Details</a></li>-->
                <li><a href="../Admin Side/slot-schedule.html">Slots Schedule</a></li>
            </ul>
        </div>
    </div>

    <div class="main-view">
        <div class="cont">
            <p class="upcoming">Profile</p>
            <hr class="divider-view">
            <div class="admin-profile"> 
                <div class="admin-profile-container">   
                    <div class="admin-profile-container1">
                        <div class="admin-label" >School Name</div>
                        <input type="text" class="admin-field" placeholder="Technological University of the Philippines" id="school" name="school">
                    </div> 
                </div>
            </div>

            <div class="admin-profile">
                <div class="admin-profile-container">   
                    <div class="admin-profile-container1">
                        <div class="admin-label" >Contact Number</div>
                        <input type="text" class="admin-field" placeholder="23013040" id="adminContactnum" name="adminContactnum">
                    </div> 

                    <div class="admin-profile-container1">
                        <div class="admin-label">Address</div>
                        <input type="text" class="admin-field" placeholder="San Marcelino St., Ayala Blvd, Ermita Manila,1000" id="adminAddress" name="adminAddress">
                    </div>
                </div> 
            </div>   
        </div> 
    </div>
    <div class="UpdateBtn-admin">
        <div><a><button>UPDATE</button></a></div>
    </div>

    <script>
    
        // Retrieve TUP ID from localStorage
        const tupID = localStorage.getItem('tupID');
        // console.log(tupID);

        // Use TUP ID to fetch user's profile
        fetch(`/profile?tupID=${tupID}`)
        .then(response => response.json())
        .then(data => {
            console.log(data);
            document.getElementById('school').value = data.school;
            document.getElementById('adminContactnum').value = data.adminContactnum;
            document.getElementById('adminAddress').value = data.adminAddress;
        })
        .catch(error => console.error('Error:', error));

        const updateProfileAdmin = () => {
            const updatedProfile = {
                school: document.getElementById('school').value = data.school,
                adminContactnum: document.getElementById('adminContactnum').value = data.adminContactnum,
                adminAddress: document.getElementById('adminAddress').value = data.adminAddress
            };

            fetch('/updateProfile', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(updatedProfile)
            })
            .then(response => response.json())
            .then(data => {
                // console.log(data);
                alert(data.message); // Show success or error message
            })
            .catch(error => console.error('Error:', error));
        };

        document.getElementById('updateBtn').addEventListener('click', updateProfile);
    </script>

    <script type="text/javascript" src="../assets/js/script.js"></script>
</body>
</html>
